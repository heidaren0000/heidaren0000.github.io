---
layout: post
title: NodeJS(ä¸‰) npm åŒ…ç®¡ç†
date: 2020-02-18 15:01:00 +0800
authorize: Daren
categories: Node
nutshell: ä»‹ç»ä¸€ä¸‹ NodeJS çš„åŒ…ç®¡ç†ç³»ç»Ÿ npm
---



## 1. ç®€ä»‹ Introduction

NPM(NodeJS Package Manager), æ˜¯ NodeJS çš„åŒ…ç®¡ç†å·¥å…·. é€šè¿‡ NPM å¯ä»¥ä¸‹è½½åˆ°æ•°ä»¥åä¸‡è®¡çš„è‡ªç”±çš„,é«˜å¯ç”¨æ€§çš„ NodeJS å·¥å…·.

å®˜ç½‘: www.npmjs.com

è¦æ³¨æ„çš„æ˜¯ npm å’Œ NodeJS åˆ†å¼€å¼€å‘çš„, åªæ˜¯å®‰è£…çš„æ—¶å€™ä¼šåŒæ—¶å®‰è£…è€Œå·².

```shell
npm i -g npm@5.5.1
# i : å®‰è£…å‚æ•°
# -g : å…¨å±€å®‰è£…
# @ : æŒ‡å®šç‰ˆæœ¬å·
```

## 2. package.json

åœ¨å‘é¡¹ç›®ä¸­æ·»åŠ  npm åŒ…ä¹‹å‰, ä½ éœ€è¦ç°åœ¨ä½ çš„é¡¹ç›®ä¸­å»ºç«‹ä¸€ä¸ª package.json. è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ä½ çš„é¡¹ç›®çš„å…ƒæ•°æ®(metadata), æ¯”å¦‚ä½œè€…, GitHub çš„æºåœ°å€ç­‰ç­‰. è¦æ–¹ä¾¿å¿«æ·çš„åˆ›å»º package.json ,å¯ä»¥ä½¿ç”¨

```shell
npm init
```

```shell
MacBook-Pro:npm-demo daren$ npm init
This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.

See `npm help json` for definitive documentation on these fields
and exactly what they do.

Use `npm install <pkg>` afterwards to install a package and
save it as a dependency in the package.json file.

Press ^C at any time to quit.
package name: (npm-demo) # é¡¹ç›®çš„åŒ…å
version: (1.0.0) # é¡¹ç›®çš„ç‰ˆæœ¬å·
description: npm-demo # é¡¹ç›®çš„æè¿°
entry point: (index.js) # é¡¹ç›®çš„è¿›å…¥ç‚¹(ä¸€èˆ¬å°±æ˜¯ index.js æˆ–è€… app.js)
test command: 
git repository: 
keywords: 
author: 
license: (ISC) 
About to write to /Users/daren/Desktop/npm-demo/package.json:

{
  "name": "npm-demo",
  "version": "1.0.0",
  "description": "npm-demo",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}


Is this OK? (yes) 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 npm update check failed                  â”‚
â”‚           Try running with sudo or get access            â”‚
â”‚           to the local update config store via           â”‚
â”‚ sudo chown -R $USER:$(id -gn $USER) /Users/daren/.config â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
MacBook-Pro:npm-demo daren$ 

```

æŒ‰ç…§è¿™ä¸€å¥—æµç¨‹ä¸‹æ¥, å°±å¯ä»¥æ–¹ä¾¿çš„å®Œæˆåˆå§‹åŒ–.

å¦‚æœä½ æƒ³è¦æ‰€æœ‰çš„é€‰é¡¹éƒ½ä¿ç•™é»˜è®¤, ç›´æ¥

```shell
npm init --yes
```

## 3. å®‰è£… Node åŒ… (Installing a Node package)

è¦å®‰è£… npm åŒ…, æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤:

```shell
npm install åŒ…å
# install å¯ä»¥ç”¨ i æ¥ä»£æ›¿
```

å®‰è£… npm åŒ…çš„è¿‡ç¨‹ä¸­, ä¼šäº§ç”Ÿä¸‹é¢çš„è¡Œä¸º:

- å°†ä¸‹è½½çš„åŒ…å®‰è£…åˆ° `node_modules` æ–‡ä»¶å¤¹ä¸­
- å°†ä¸‹è½½çš„åŒ…åä»¥åŠç‰ˆæœ¬æ·»åŠ åˆ° `package.json` ä¸­çš„ `dependences`é‡Œ, æ— è®ºå®‰è£…æ˜¯å¦æˆåŠŸ, éƒ½ä¼šæ·»åŠ è¿›å».

![](https://raw.githubusercontent.com/heidaren0000/blogGallery/master/imgs/1-1-1-package-json.png)

## 4. ä½¿ç”¨ npm åŒ… (using a package)

è¦æ˜¯ç”¨æ–°ä¸‹è½½çš„ package, å¯ä»¥ç›´æ¥ä½¿ç”¨ require() æ¥å¯¼å…¥åŒ…

```javascript
var _ = require('underscore');

```

ä½ å¯èƒ½å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™è¿˜èƒ½æ‰¾åˆ°è¿™ä¸ªåŒ…, å…¶å®è¿™ä¸ª`çš„`require()` çš„ç”¨æ³•æ˜¯è¿™æ ·çš„:

- è‡ªå¸¦çš„æ¨¡å— (core module)
- å½“å‰ç›®å½•çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ (file of folder)
- åœ¨ `node_modules`æ–‡ä»¶å¤¹çš„å†…å®¹ (node_modules)

å½“ä½ ä½¿ç”¨`-g`å‚æ•°å®‰è£…çš„ npm åŒ…, ä¼šè¢«å®‰è£…åˆ° `core module` ä¸­, ä¹Ÿå¯ä»¥è¢«æ­£å¸¸è°ƒç”¨. 

## 5. åŒ…ä¾èµ– (Package Dependencies)

å‡å¦‚æˆ‘ä»¬è¦å®‰è£…ä¸€ä¸ª`mongoose`,

```shell
npm i mongoose
```

å®‰è£…å®Œäº†, æˆ‘ä»¬çœ‹ä¸€ä¸‹`node_modules`æ–‡ä»¶å¤¹:

```shell
MacBook-Pro:node_modules daren$ ls
bl				ms
bluebird			process-nextick-args
bson				readable-stream
core-util-is			regexp-clone
debug				require_optional
denque				resolve-from
inherits			safe-buffer
isarray				saslprep
kareem				semver
memory-pager			sift
mongodb				sliced
mongoose			sparse-bitfield
mongoose-legacy-pluralize	string_decoder
mpath				underscore
mquery				util-deprecate
MacBook-Pro:node_modules daren$ 

```

å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸æ­¢å®‰è£…äº† mongoose , è¿˜å®‰è£…äº†ä¸€å †åŒ…, mongoose æ˜¯æˆ‘ä»¬é¡¹ç›®çš„ä¾èµ–åŒ…, è€Œè¿™äº›åŒ…æ˜¯ mongoose çš„ä¾èµ–åŒ…. 

åœ¨è€ç‰ˆæœ¬çš„ npm ä¸­, ä¾èµ–åŒ…çš„ä¾èµ–åŒ…éƒ½å®‰è£…åœ¨ä¾èµ–åŒ…ç›®å½•è‡ªå·±çš„ 'node_modules' é‡Œé¢, è¿™ç§åƒå¥—å¨ƒä¸€æ ·çš„ç»“æ„ä½¿å¾—ä¸€äº›åŒ…ä¸å¾—ä¸é‡å¤å®‰è£…, è€Œåƒ Windows è¿™ç§å¯¹è·¯å¾„é•¿åº¦æœ‰è¦æ±‚çš„æ“ä½œç³»ç»Ÿä¸‹è¿˜æœ‰ä¸èƒ½è¿è¡Œçš„å¯èƒ½.

åœ¨æ–°ç‰ˆæœ¬çš„ npm ä¸­, ä¾èµ–åŒ…çš„ä¾èµ–åŒ…, ä¼šç»Ÿä¸€æ”¾åœ¨é¡¹ç›®é‡Œç»Ÿä¸€çš„ä¸€ä¸ª`node_modules`ä¸­, æ‰€ä»¥`node_modules`æ–‡ä»¶å¤¹ä¸­é™¤äº†åˆšæ‰å®‰è£…çš„ mongoose, è¿˜å¤šäº†å¾ˆå¤šä¸œè¥¿.

è€Œå¦‚æœå‡ºç°äº†åŒæ—¶éœ€è¦ä¸€ä¸ªä¾èµ–åŒ…, å¹¶ä¸”ç‰ˆæœ¬å‡ºç°å†²çªæ—¶(åŒä¸€ä¸ªåŒ…çš„ä¸¤ä¸ªç‰ˆæœ¬è¢«éœ€è¦), è¿™æ—¶æ‰ä¼šå°†ä¾èµ–åŒ…å®‰è£…åˆ°éœ€è¦è¿™ä¸ªç‰ˆæœ¬çš„åŒ…çš„`node_modules`ç›®å½•é‡Œ.

## 6. NPM åŒ…å’Œè½¯ä»¶é…ç½®ç®¡ç† (NPM Packages and SCM)

`node_modules`æ–‡ä»¶å¤¹ä¸­å­˜å‚¨äº†æœºä¼šæ‰€æœ‰çš„ä¾èµ–åŒ…, è¿™äº›ä¾èµ–åŒ…åœ¨æŸäº›é¡¹ç›®ä¸­ç”šè‡³èƒ½è¾¾åˆ°ä¸Šç™¾å…†, å½“ä½ éœ€è¦ä½¿ç”¨åƒ git è¿™æ ·çš„ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿçš„æ—¶å€™, ä¸ºäº†èŠ‚çœæ—¶é—´, æ²¡å¿…è¦è¿å¸¦ç€`node_module`æ–‡ä»¶å¤¹ä¸€åŒè¿›è¡Œ commit, ç›´æ¥æ”¾åˆ° `.gitignore`æ–‡ä»¶ä¸­å°±å¯ä»¥äº†.

å¦‚æœä½ éœ€è¦é‡æ–°ç»™é¡¹ç›®å®‰è£…ä¾èµ–åŒ…,ç›´æ¥

```shell
npm i # æˆ–è€… install
```

å°±å¯ä»¥é‡æ–°ä¸‹è½½ä¾èµ–åŒ…äº†.

## 7. è¯­ä¹‰ç‰ˆæœ¬å· (Semantic Versioning)

è¯­ä¹‰ç‰ˆæœ¬å·(Semantic Versioning) è¢«å¹¿æ³›é‡‡ç”¨, æ¯”å¦‚æˆ‘ä»¬æ‰“å¼€ package.json å°±ä¼šçœ‹åˆ°ä¾èµ–åŒ…çš„ç‰ˆæœ¬å‘½åå°±æ˜¯ç”¨çš„è¯­ä¹‰ç‰ˆæœ¬å·(Semantic Versioning .aka SemVer)

![](https://raw.githubusercontent.com/heidaren0000/blogGallery/master/imgs/7-1-1-semantic-Versioning.png)

è¿™ç§ç‰ˆæœ¬å·å°±æ˜¯ä¸‰ç»„æ•°å­—

Major.Minor.Patch 

ä¸»è¦ç‰ˆæœ¬.å°ç‰ˆæœ¬.è¡¥ä¸ç‰ˆæœ¬

- è¡¥ä¸ç‰ˆæœ¬: ä¸»è¦æ˜¯ä¿®å¤ bug æˆ–è€…ä¿®å¤å®‰å…¨é—®é¢˜, ä¸ä¼šå¯¹ API è¿›è¡Œæ”¹åŠ¨
- å°ç‰ˆæœ¬: å¢åŠ åŠŸèƒ½, ä¸ä¼šç ´ååŸæœ‰ API
- ä¸»è¦ç‰ˆæœ¬: å¯èƒ½ä¼šä¿®æ”¹æŸäº› API, å¯¼è‡´ä¾èµ–è¿™ä¸ªçš„åŒ…ä¸èƒ½æ­£å¸¸å·¥ä½œ.

è¿˜æœ‰äº›ç‰¹æ®Šçš„ç¬¦å·, æ¯”å¦‚`^`(Caret)å’Œ`~`(Tilde)

- `^`ä¸»è¦ç‰ˆæœ¬ä¸å˜å³å¯ 4.X
- `~`ä¸»è¦ç‰ˆæœ¬å’Œå°ç‰ˆæœ¬éƒ½ä¸èƒ½å˜ 1.8.X

å¦‚æœä½ æƒ³è¦ä¿æŒç‰ˆæœ¬å·ä¸å˜, é‚£ä¹ˆå°±ç›´æ¥å†™æ•°å­—å°±å¥½, ä¸ç”¨åœ¨å‰é¢åŠ ç‰¹æ®Šç¬¦å·äº†å°±.

## 8. åˆ—å‡ºå·²å®‰è£…åŒ…(Listing the Installed Packages)

### 1. çœ‹ `node_module`

ç›´æ¥åœ¨`node_module`æ–‡ä»¶å¤¹æ‰¾åˆ°è¿™ä¸ªåŒ…, ç‚¹è¿›å»çœ‹ package.json å°±è¡Œ.

![](https://raw.githubusercontent.com/heidaren0000/blogGallery/master/imgs/8-1-1-check-pacakge-version.png)

ä¸Šé¢çš„æ–¹æ³•çœ‹å¤šä¸ªåŒ…çš„ç‰ˆæœ¬ä¼šå¾ˆç—›è‹¦, ä¸‹é¢çš„æ–¹æ³•æ›´å¥½äº›

### 2. å‘½ä»¤è¡Œå·¥å…·

```shell
npm list
```

è¿™ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥çœ‹åˆ°å·²ç»å®‰è£…å¥½çš„æ‰€æœ‰çš„åŒ….

```shell
MacBook-Pro:node_modules daren$ npm list
npm-demo@1.0.0 /Users/daren/Desktop/npm-demo
â”œâ”€â”¬ mongoose@5.9.1
â”‚ â”œâ”€â”€ bson@1.1.3
â”‚ â”œâ”€â”€ kareem@2.3.1
â”‚ â”œâ”€â”¬ mongodb@3.5.3
â”‚ â”‚ â”œâ”€â”¬ bl@2.2.0
â”‚ â”‚ â”‚ â”œâ”€â”¬ readable-stream@2.3.7
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€ core-util-is@1.0.2
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€ inherits@2.0.4
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€ isarray@1.0.0
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€ process-nextick-args@2.0.1
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”€ safe-buffer@5.1.2 deduped
â”‚ â”‚ â”‚ â”‚ â”œâ”€â”¬ string_decoder@1.1.1
â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€ safe-buffer@5.1.2 deduped
â”‚ â”‚ â”‚ â”‚ â””â”€â”€ util-deprecate@1.0.2
â”‚ â”‚ â”‚ â””â”€â”€ safe-buffer@5.1.2 deduped
â”‚ â”‚ â”œâ”€â”€ bson@1.1.3 deduped
â”‚ â”‚ â”œâ”€â”€ denque@1.4.1
â”‚ â”‚ â”œâ”€â”¬ require_optional@1.0.1
â”‚ â”‚ â”‚ â”œâ”€â”€ resolve-from@2.0.0
â”‚ â”‚ â”‚ â””â”€â”€ semver@5.7.1
â”‚ â”‚ â”œâ”€â”€ safe-buffer@5.1.2 deduped
â”‚ â”‚ â””â”€â”¬ saslprep@1.0.3
â”‚ â”‚   â””â”€â”¬ sparse-bitfield@3.0.3
â”‚ â”‚     â””â”€â”€ memory-pager@1.5.0
â”‚ â”œâ”€â”€ mongoose-legacy-pluralize@1.0.2
â”‚ â”œâ”€â”€ mpath@0.6.0
â”‚ â”œâ”€â”¬ mquery@3.2.2
â”‚ â”‚ â”œâ”€â”€ bluebird@3.5.1
â”‚ â”‚ â”œâ”€â”¬ debug@3.1.0
â”‚ â”‚ â”‚ â””â”€â”€ ms@2.0.0
â”‚ â”‚ â”œâ”€â”€ regexp-clone@1.0.0 deduped
â”‚ â”‚ â”œâ”€â”€ safe-buffer@5.1.2 deduped
â”‚ â”‚ â””â”€â”€ sliced@1.0.1 deduped
â”‚ â”œâ”€â”€ ms@2.1.2
â”‚ â”œâ”€â”€ regexp-clone@1.0.0
â”‚ â”œâ”€â”€ safe-buffer@5.1.2
â”‚ â”œâ”€â”€ sift@7.0.1
â”‚ â””â”€â”€ sliced@1.0.1
â””â”€â”€ underscore@1.9.2


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 npm update check failed                  â”‚
â”‚           Try running with sudo or get access            â”‚
â”‚           to the local update config store via           â”‚
â”‚ sudo chown -R $USER:$(id -gn $USER) /Users/daren/.config â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
MacBook-Pro:node_modules daren$ 

```

è¿˜å¯ä»¥è§„å®šæŸ¥çœ‹çš„æ·±åº¦, æ¯”å¦‚æˆ‘åªæƒ³çœ‹é¡¹ç›®æœ¬èº«çš„åŒ…, è€Œä¸æ˜¯ä¾èµ–åŒ…çš„åŒ…, é‚£ä¹ˆå¯ä»¥è§„å®šæ·±åº¦ä¸º 0.

```shell
npm list --depth=0
```

```shell
MacBook-Pro:node_modules daren$ npm list --depth=0
npm-demo@1.0.0 /Users/daren/Desktop/npm-demo
â”œâ”€â”€ mongoose@5.9.1
â””â”€â”€ underscore@1.9.2


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 npm update check failed                  â”‚
â”‚           Try running with sudo or get access            â”‚
â”‚           to the local update config store via           â”‚
â”‚ sudo chown -R $USER:$(id -gn $USER) /Users/daren/.config â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
MacBook-Pro:node_modules daren$ 

```

## 9. æŸ¥çœ‹ npm åŒ…çš„æ³¨å†Œä¿¡æ¯ (viewing registry information about npm packages)

### 1. å»å®˜ç½‘

åœ¨ npmjs.com å¯ä»¥æŸ¥åˆ°è¿™ä¸ª npm åŒ…ç›¸å…³ä¿¡æ¯

![](https://raw.githubusercontent.com/heidaren0000/blogGallery/master/imgs/9-1-1-npmjs-info.png)

### 2. å‘½ä»¤è¡Œ npm view

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ä¹Ÿèƒ½æŸ¥åˆ°åŒ…çš„ç›¸å…³ä¿¡æ¯

```shell
npm view åŒ…å
```

```shell
MacBook-Pro:node_modules daren$ npm view mongoose

mongoose@5.9.1 | MIT | deps: 11 | versions: 575
Mongoose MongoDB ODM
https://mongoosejs.com

dist
.tarball: https://registry.npm.taobao.org/mongoose/download/mongoose-5.9.1.tgz
.shasum: 48a5fafe6bc7b57d6b41b12ebf55fa5f609518d6

dependencies:
bson: ~1.1.1                     ms: 2.1.2                        
kareem: 2.3.1                    regexp-clone: 1.0.0              
mongodb: 3.5.3                   safe-buffer: 5.1.2               
mongoose-legacy-pluralize: 1.0.2 sift: 7.0.1                      
mpath: 0.6.0                     sliced: 1.0.1                    
mquery: 3.2.2                    

maintainers:
- aaron <aaron.heckmann+github@gmail.com>
- rauchg <rauchg@gmail.com>
- tjholowaychuk <tj@vision-media.ca>
- vkarpov15 <valkar207@gmail.com>

dist-tags:
latest: 5.9.1    legacy: 4.13.19  unstable: 3.9.7  

published 3 days ago by vkarpov15 <val@karpov.io>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 npm update check failed                  â”‚
â”‚           Try running with sudo or get access            â”‚
â”‚           to the local update config store via           â”‚
â”‚ sudo chown -R $USER:$(id -gn $USER) /Users/daren/.config â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
MacBook-Pro:node_modules daren$ 
```

è¦æ˜¯æ„Ÿè§‰ä¿¡æ¯å¤ªå¤šå¤ªä¹±, è¿˜å¯ä»¥ç›´æ¥çœ‹ç›¸å…³çš„å±æ€§, ä¸‹é¢ä¸¾ä¾‹å­æŸ¥çœ‹ mongoose çš„ä¾èµ–ä¿¡æ¯:

```shell
npm view mongoose dependencies
```

```shell
MacBook-Pro:node_modules daren$ npm view mongoose dependencies
 
{ bson: '~1.1.1',
  kareem: '2.3.1',
  mongodb: '3.5.3',
  'mongoose-legacy-pluralize': '1.0.2',
  mpath: '0.6.0',
  mquery: '3.2.2',
  ms: '2.1.2',
  'regexp-clone': '1.0.0',
  'safe-buffer': '5.1.2',
  sliced: '1.0.1',
  sift: '7.0.1' }
```

è¿˜å¯ä»¥åˆ—å‡ºè¿™ä¸ªåŒ…çš„æ‰€æœ‰ç‰ˆæœ¬, è¿˜æ‹¿ mongoose ä¸¾ä¾‹

```shell
node view mongoose versions
```

## 10. å®‰è£…ç‰¹å®šç‰ˆæœ¬è½¯ä»¶åŒ… (Installing a Specific Version of a Package)

æœ‰æ—¶å€™éœ€è¦å®‰è£…çš„ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°ç‰ˆ, å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å®‰è£…, æ‹¿ mongoose ä¸¾ä¾‹

```shell
npm i mongoose@4.5.1
```

ç”¨`@`åé¢æ¥ç‰ˆæœ¬å·çš„æ–¹å¼æ¥è¿›è¡ŒæŒ‡å®šç‰ˆæœ¬å·, è¿™ä¹ˆå®‰è£…ä¹‹å, package.json ä¸­çš„ç‰ˆæœ¬å·ä¹Ÿä¼šæ˜¯è¿™ä¸ªç‰ˆæœ¬.

## 11. å‡çº§åŒ…ç‰ˆæœ¬(Updating Local Packages)

å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æ£€æŸ¥åŒ…æ˜¯å¦å·²ç»è¿‡æ—¶(outdated):

```shell
npm outdated
```

è¿™é‡Œç”¨`underscore`æ¥ä¸¾ä¾‹, 

```shell
MacBook-Pro:node_modules daren$ npm outdated
Package     Current  Wanted  Latest  Location
underscore    1.4.0   1.9.2   1.9.2  npm-demo
MacBook-Pro:node_modules daren$ 
```

å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸‰ä¸ªç‰ˆæœ¬, Current(å½“å‰ç‰ˆæœ¬), Wanted(æ‰€éœ€ç‰ˆæœ¬), Latest(æœ€æ–°ç‰ˆæœ¬).

- å½“å‰ç‰ˆæœ¬: ç›®å‰æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬
- æ‰€éœ€ç‰ˆæœ¬: æ ¹æ®package.jsonæ¨ç®—å‡ºçš„ç‰ˆæœ¬, æ¯”å¦‚`^2.1.0`ä¼šæŒ‰ç…§å¤§ç‰ˆæœ¬å·`2.X.X`è¿›è¡Œæ›´æ–°. `~2.1.0`ä¼šæŒ‰ç…§å°ç‰ˆæœ¬å·`2.1.X`è¿›è¡Œæ›´æ–°. ç”±äºå¤§ç‰ˆæœ¬å¯èƒ½ä¼šç ´ååŸæœ‰çš„ API, æ‰€ä»¥æœ‰çš„æ—¶å€™å¹¶ä¸æ˜¯æœ€æ–°ç‰ˆå°±æœ€å¥½, è€Œæ˜¯åœ¨åˆé€‚çš„æƒ…å†µä¸‹é€‰æ‹©æœ€é€‚åˆçš„ç‰ˆæœ¬.
- æœ€æ–°ç‰ˆæœ¬: å°±æ˜¯æœ€æ–°ç‰ˆæœ¬

å¦‚æœæƒ³è¦å‡çº§åŒ…çš„è¯, å¯ä»¥ä½¿ç”¨å‘½ä»¤

```shell
npm update
```

è¿™ä¹ˆåšä¼šå‡çº§åˆ°æœ€æ–°çš„æ‰€éœ€ç‰ˆæœ¬, ä½†æ˜¯ä¸ä¸€å®šæ˜¯æœ€æ–°ç‰ˆæœ¬.

å¦‚æœè¦å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬, å¯ä»¥ä½¿ç”¨ä¸€ä¸ª npm åŒ…, å«åš `npm-check-updates`(åˆ«å¿˜äº†s)

```shell
npm i --g npm-check-updates
```

ç„¶åå°±å¯ä»¥æ–¹ä¾¿çš„æ£€æŸ¥æ˜¯å¦æœ‰å¯ä»¥å‡çº§åˆ°æœ€æ–°ç‰ˆçš„åŒ…

```shell
MacBook-Pro:node_modules daren$ npm-check-updates
Checking /Users/daren/Desktop/npm-demo/package.json
[====================] 2/2 100%

 underscore  ^1.4.0  â†’  ^1.9.2 

Run ncu -u to upgrade package.json


```

æ³¨æ„è¿™é‡Œåªæ˜¯è¿›è¡Œäº†æ£€æŸ¥, æ²¡æœ‰ä»»ä½•çš„æ“ä½œ. åœ¨ shell è¾“å‡ºçš„æœ€åä¸€è¡Œå¯ä»¥çœ‹åˆ°:â€˜Run ncu -u to upgrade package.jsonâ€™, æ‰§è¡Œ `ncu -u` æ¥å¯¹ package.json è¿›è¡Œæ›´æ–°. `ncu` å°±æ˜¯`np-check-updates`çš„ç¼©å†™.

```shell
ncu -u
```

è¿™ä¸ªæ‰§è¡Œä¹‹ååªæ˜¯æ›´æ–°äº† package.json ä¸­çš„ä¾èµ–ç‰ˆæœ¬å·, å¹¶æ²¡æœ‰è¿›è¡ŒçœŸæ­£çš„åŒ…æ›´æ–°, ç°åœ¨æˆ‘ä»¬è¿˜è¦è¿›è¡Œ`npm install`é‡å»ºä¾èµ–åŒ…çš„ç»“æ„

```shell
npm install
```

## 12. å¼€å‘ç”¨é€”ä¾èµ–åŒ…(DevDependencies)

æœ‰æ—¶å€™æœ‰çš„åŒ…æ˜¯ç”¨æ¥ debug ç”¨çš„, å¹¶ä¸ä¼šåœ¨éƒ¨ç½²çš„æ—¶å€™ç”¨åˆ°. è¿™æ—¶å€™å°±è¦ç”¨åˆ° å¼€å‘ç”¨é€”ä¾èµ–åŒ…(DevDependencies), è¿™ç§ä¾èµ–åŒ…åœ¨éƒ¨ç½²çš„æ—¶å€™ä¸ä¼šè¢«å®‰è£….

è¿™é‡Œç”¨ js çš„ debug å·¥å…· jshint å®‰è£…æˆå¼€å‘ç”¨ä¾èµ–åŒ…è¿›è¡Œä¸¾ä¾‹:

```shell
MacBook-Pro:node_modules daren$ sudo npm install jshint --save-dev
Password:
npm WARN npm-demo@1.0.0 No repository field.

+ jshint@2.11.0
added 29 packages from 15 contributors and removed 1 package in 2.073s
MacBook-Pro:node_modules
```

å®‰è£…å®Œæˆä¹‹å,  package.json ä¹Ÿæœ‰äº†ç›¸åº”çš„å˜åŒ–:

```json
  "dependencies": {
    "mongoose": "^5.9.1",
    "underscore": "^1.9.2"
  },
  "devDependencies": {
    "jshint": "^2.11.0"
  }
```

å¤šäº†ä¸€ä¸ªä¸“é—¨çš„ä»£ç å—`devDependencies`

è€Œ jshint å®‰è£…çš„ä½ç½®è¿˜æ˜¯åœ¨ `node_modules` ä¸­.

## 13. åˆ é™¤åŒ…(Uninstalling Packages)

è¿˜æ˜¯æ‹¿ mongoose ä¸¾ä¾‹

```shell
npm uninstall mongoose
# uninstall ä¹Ÿå¯ä»¥ç®€å†™æˆ un
```

åœ¨è¿™ä¹‹å, mongoose å°±ä¼šè¢« package.json å’Œ node_modules ä¸­ç§»é™¤.

## 14. å…¨å±€åŒ…(Working with Global Packages)

é»˜è®¤æƒ…å†µä¹‹ä¸‹ä½¿ç”¨`npm i`åªä¼šåœ¨æœ¬åœ°çš„é¡¹ç›®ä¸­å®‰è£…ä¾èµ–åŒ…. ç„¶è€Œæœ‰çš„åŒ…æ›´é€‚åˆåœ¨å…¨å±€ä¸­ä½¿ç”¨, æ¯”å¦‚åƒ `lodash` å’Œ `underscore` è¿˜æœ‰ä¸€äº›å‘½ä»¤è¡Œå·¥å…·, åƒ`npm`æœ¬èº«å°±æ˜¯åœ¨å…¨å±€å®‰è£…çš„å‘½ä»¤è¡Œå·¥å…·, æˆ–è€…`vue/cli`ç­‰ç­‰.

è¦å®‰è£…å…¨å±€çš„åŒ…, å¯ä»¥åœ¨åŸæ¥çš„å®‰è£…å‘½ä»¤ä¸Šå¸¦ä¸€ä¸ª`-g`å‚æ•°

```shell
npm i -g vue
```

å…¶å®å¤§éƒ¨åˆ†çš„åŒ…ç®¡ç†å‘½ä»¤è¦ä¸Šå‡åˆ°å…¨å±€éƒ½å¯ä»¥é€šè¿‡å¸¦ä¸€ä¸ª`-g`æ¥è¿›è¡Œ

```shell
npm outdated -g
npm uninstall -g
ncu -g
...
```

## 15. å‘å¸ƒä¸€ä¸ªåŒ… (Publish a Package)

ä½ ä¹Ÿå¯ä»¥å‘å¸ƒè‡ªå·±å†™çš„åŒ…

### 1. æ³¨å†Œè´¦æˆ·

ä½¿ç”¨`npm adduser`æ¥æ³¨å†Œä¸€ä¸ªä»“åº“(repository)

```shell
MacBook-Pro:node_modules daren$ npm adduser
Username: heidaren0000
Password: 
Email: (this IS public) heidaren0000@gmail.com
Logged in as heidaren0000 on http://registry.npm.taobao.org/.
```

### 2. ç™»é™†

ä½¿ç”¨`npm login`æ¥è¿›è¡Œç™»å½•

```shell
MacBook-Pro:node_modules daren$ npm login
Username: (heidaren0000) 
Password: (<default hidden>) 
Email: (this IS public) (heidaren0000@gmail.com) 
Logged in as heidaren0000 on http://registry.npm.taobao.org/.
```

### 3. å‘å¸ƒ

è¿™é‡Œå†™äº†ä¸€ä¸ªç®€å•çš„å°é¡¹ç›®`daren-Hello`, å¯ä»¥æ‰§è¡Œç®€å•çš„åŠ æ³•. æˆ‘ä»¬æŠŠå®ƒå‘å¸ƒä¸€ä¸‹, ç”¨`npm publish`

```shell
MacBook-Pro:daren-hello daren$ npm publish
npm notice 
npm notice ğŸ“¦  daren-hello@1.0.0
npm notice === Tarball Contents === 
npm notice 229B package.json
npm notice 46B  index.js    
npm notice === Tarball Details === 
npm notice name:          daren-hello                             
npm notice version:       1.0.0                                   
npm notice package size:  328 B                                   
npm notice unpacked size: 275 B                                   
npm notice shasum:        7af193a7ef2e6ddfccbbe05df9f496d369d6614d
npm notice integrity:     sha512-TciwyV/8/UHLd[...]/bqF+0LHJbm9Q==
npm notice total files:   2                                       
npm notice 
npm ERR! code E403
npm ERR! 403 Forbidden - PUT http://registry.npm.taobao.org/daren-hello - [no_perms] Private mode enable, only admin can publish this module

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/daren/.npm/_logs/2020-02-18T14_56_45_925Z-debug.log
```

ä½†æ˜¯è¿™é‡Œæ˜æ˜¾å°±æ˜¯æ²¡æœ‰å‘å¸ƒä¸Š, å› ä¸ºæˆ‘ç”¨çš„æºæ˜¯æ·˜å®çš„`cnpm`, å®ƒçš„ç®¡ç†å‘˜å¼€äº†`private mode`, åªæœ‰ç®¡ç†å‘˜æ‰èƒ½å‘å¸ƒåŒ….

### 4.ä½¿ç”¨

å¦‚æœèƒ½å‘å¸ƒæˆåŠŸçš„è¯, å°±å¯ä»¥ç›´æ¥ç”¨`npm install`æ¥å®‰è£…äº†.

å‘å¸ƒçš„è¿‡ç¨‹ä¸­`package.json`ä¼šè‡ªåŠ¨å¢åŠ ä¸€äº›å…ƒæ•°æ®(meta data), çœ‹èµ·æ¥ä¼šå’ŒåŸæ¥çš„æœ‰ç‚¹åŒºåˆ«.

## 16. æ›´æ–°å·²å‘å¸ƒçš„åŒ…(Updating a Published Package)

å‘å¸ƒæ›´æ–°çš„æ—¶å€™åªè¦æ³¨æ„ç‰ˆæœ¬å·ä¸èƒ½æ¯”ä»¥å‰æ›´æ—§å°±å¯ä»¥ç”¨`npm publish`å¯¹è‡ªå·±çš„æºä¸­çš„ npm è½¯ä»¶åŒ…è¿›è¡Œæ›´æ–°.

æ‰€ä»¥å¯ä»¥ä½¿ç”¨`npm version`æ¥åˆ·ç‰ˆæœ¬å·

```shell
npm version major 
# æ›´æ–°ä¸»è¦ç‰ˆæœ¬, ä¹Ÿå°±æ˜¯ä¸»è¦ç‰ˆæœ¬å· +1
npm version minor
# æ›´æ–°å°ç‰ˆæœ¬å·, ä¹Ÿå°±æ˜¯å°ç‰ˆæœ¬å· +1
npm version patch
# æ›´æ–°è¡¥ä¸ç‰ˆæœ¬å·, è¡¥ä¸ç‰ˆæœ¬å· +1
```

```shell
MacBook-Pro:daren-hello daren$ npm version minor
v1.1.0
```

å°±æ˜¯è¿™æ ·. ç„¶åå°±èƒ½ç”¨ `npm publish` æ›´æ–°æºä¸­çš„åŒ…äº†.